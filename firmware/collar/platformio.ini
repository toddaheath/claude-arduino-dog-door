; PlatformIO Project Configuration
; Smart Dog Door - Collar Device Firmware (ESP32-S3)

[env:collar]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
board_build.mcu = esp32s3
board_build.f_cpu = 240000000L
board_build.f_flash = 80000000L
board_build.flash_mode = qio
board_build.flash_size = 8MB
board_build.partitions = default_8MB.csv

; USB native for programming (no FTDI needed)
board_build.arduino.cdc_on_boot = "1"

monitor_speed = 115200

lib_deps =
    bblanchon/ArduinoJson@^7.0.0
    sparkfun/SparkFun u-blox GNSS v3@^3.1.1
    stm32duino/STM32duino LSM6DSO@^2.2.0
    h2zero/NimBLE-Arduino@^1.4.1
    adafruit/Adafruit PN532@^1.3.3
    ; mbedtls included in ESP32 SDK

build_flags =
    -DCONFIG_BT_ENABLED
    -DCONFIG_NIMBLE_ENABLED
    -DBOARD_HAS_PSRAM
    -DARDUINO_USB_MODE=1
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DCOLLAR_FW_VERSION=\"1.0.0\"

; Native test environment
[env:native]
platform = native
test_framework = unity
build_flags =
    -DUNIT_TEST
    -DCOLLAR_FW_VERSION=\"1.0.0\"
